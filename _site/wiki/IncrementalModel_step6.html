
    <!doctype html><html lang="en"><head><meta charset="utf-8"><title>6. Multi-Level</title></head>
    <body>
    <link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/w3.css">
<link rel="stylesheet" href="/css/font-awesome.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="//connect.facebook.net/en_US/all.js"></script>
<script src="/js/linkify.min.js"></script>
<script src="/js/linkify-jquery.min.js"></script>

    <div class="w3-bar w3-white w3-hide-small">
      <a href="/" class="w3-bar-item w3-button"><img src="/images/icon_gama_50.png"></a>
      <a href="/wiki/Home" class="w3-bar-item w3-button w3-text-blue">Documentation</a>
      <a href="/wiki/Tutorials" class="w3-bar-item w3-button w3-text-blue">Tutorials</a>
      <a href="/download" class="w3-bar-item w3-button w3-text-blue">Download</a>
      <a href="/news" class="w3-bar-item w3-button w3-text-blue">News</a>
      <a href="/contribute" class="w3-bar-item w3-button w3-text-blue">Contribute</a>
    </div>

    <div class="w3-row-padding w3-padding-64 w3-container">
        <div>
             <div class="w3-quarter" style="width:260px">
		<nav class="w3-bar-block w3-collapse w3-large w3-theme-l5 w3-animate-left w3-small"  style="z-index:3;margin-left:10px" id="mySidebar">
                    <div class="w3-medium w3-text-blue" style="font-weight:bold"><div>
<a href='/wiki/Tutorials'>Tutorials
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/LearnGAMLStepByStep'>Learn GAML Step by Step
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/Introduction'>Introduction
</a><br/>
<a href='/wiki/StartWithGAML'>Start with GAML
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/ModelOrganization'>Organization of a model
</a><br/>
<a href='/wiki/BasicProgrammingConceptsInGAML'>Basic programming concepts in GAML
</a><br/>
    </div>
<a href='/wiki/ManipulateBasicSpecies'>Manipulate basic species
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/GlobalSpecies'>The global species
</a><br/>
<a href='/wiki/RegularSpecies'>Regular species
</a><br/>
<a href='/wiki/DefiningActionsAndBehaviors'>Defining actions and behaviors
</a><br/>
<a href='/wiki/InteractionBetweenAgents'>Interaction between agents
</a><br/>
<a href='/wiki/AttachingSkills'>Attaching Skills
</a><br/>
<a href='/wiki/Inheritance'>Inheritance
</a><br/>
    </div>
<a href='/wiki/DefiningAdvancedSpecies'>Defining advanced species
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/GridSpecies'>Grid Species
</a><br/>
<a href='/wiki/GraphSpecies'>Graph Species
</a><br/>
<a href='/wiki/MirrorSpecies'>Mirror species
</a><br/>
<a href='/wiki/MultiLevelArchitecture'>Multi-level architecture
</a><br/>
    </div>
<a href='/wiki/DefiningGUIExperiment'>Defining GUI Experiment
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/DefiningParameters'>Defining Parameters
</a><br/>
<a href='/wiki/DefiningDisplaysGeneralities'>Defining displays (Generalities)
</a><br/>
<a href='/wiki/DefiningCharts'>Defining Charts
</a><br/>
<a href='/wiki/Defining3DDisplays'>Defining 3D Displays
</a><br/>
<a href='/wiki/DefiningMonitorsAndInspectors'>Defining monitors and inspectors
</a><br/>
<a href='/wiki/DefiningExportFiles'>Defining export files
</a><br/>
<a href='/wiki/DefiningUserInteraction'>Defining user interaction
</a><br/>
    </div>
<a href='/wiki/ExploringModels'>Exploring Models
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/RunSeveralSimulations'>Run Several Simulations
</a><br/>
<a href='/wiki/BatchExperiments'>Defining Batch Experiments
</a><br/>
<a href='/wiki/ExplorationMethods'>Exploration Methods
</a><br/>
    </div>
<a href='/wiki/OptimizingModels'>Optimizing Models
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/RuntimeConcepts'>Runtime Concepts
</a><br/>
OptimizingModelsSelection
    </div>
<a href='/wiki/MultiParadigmModeling'>Multi-Paradigm Modeling
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/ControlArchitecture'>Control Architectures
</a><br/>
<a href='/wiki/Equations'>Using Equations
</a><br/>
    </div>
    </div>
<a href='/wiki/Recipes'>Recipes
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/ManipulateOSMDatas'>Manipulate OSM Datas
</a><br/>
<a href='/wiki/Diffusion'>Implementing diffusion
</a><br/>
<a href='/wiki/UsingDatabase'>Using Database Access
</a><br/>
<a href='/wiki/CallingR'>Calling R
</a><br/>
<a href='/wiki/UsingFIPAACL'>Using FIPA ACL
</a><br/>
<a href='/wiki/GamAnalyzer'>Using GAMAnalyzer
</a><br/>
<a href='/wiki/UsingBDI'>Using BDI
</a><br/>
<a href='/wiki/UsingDrivingSkill'>Advanced Driving Skill
</a><br/>
<a href='/wiki/ManipulateDates'>Manipulate Dates
</a><br/>
<a href='/wiki/ManipulateLight'>Implementing light
</a><br/>
<a href='/wiki/Comodel'>Using Comodel
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
—Headlessmodefordummies
    </div>
    </div>
    </div>
<a href='/wiki/Tutorials'>Tutorials
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/LuneraysFlu'>Luneray's flu
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/LuneraysFlu_step1'>1. Creation of a first basic disease spreading model
</a><br/>
<a href='/wiki/LuneraysFlu_step2'>2. Definition of monitors and chart outputs
</a><br/>
<a href='/wiki/LuneraysFlu_step3'>3. Importation of GIS data
</a><br/>
<a href='/wiki/LuneraysFlu_step4'>4. Use of a graph to constraint the movements of people]
</a><br/>
<a href='/wiki/LuneraysFlu_step5'>5. Definition of 3D displays
</a><br/>
    </div>
<a href='/wiki/IncrementalModel'>Incremental Model
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/IncrementalModel_step1'>1. Simple SI Model
</a><br/>
<a href='/wiki/IncrementalModel_step2'>2. Charts
</a><br/>
<a href='/wiki/IncrementalModel_step3'>3. Integration of GIS Data
</a><br/>
<a href='/wiki/IncrementalModel_step4'>4. Movement on Graph
</a><br/>
<a href='/wiki/IncrementalModel_step5'>5. Visualizing in 3D
</a><br/>
<a href='/wiki/IncrementalModel_step6'>6. Multi-Level
</a><br/>
<a href='/wiki/IncrementalModel_step7'>7. Differential Equations
</a><br/>
    </div>
<a href='/wiki/PredatorPrey'>Predator Prey
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/PredatorPrey_step1'>1. Basic Model
</a><br/>
<a href='/wiki/PredatorPrey_step2'>2. Vegetation Dynamic
</a><br/>
<a href='/wiki/PredatorPrey_step3'>3. Prey Agent Behavior
</a><br/>
<a href='/wiki/PredatorPrey_step4'>4. Inspectors and Monitors
</a><br/>
<a href='/wiki/PredatorPrey_step5'>5. Predator Agent
</a><br/>
<a href='/wiki/PredatorPrey_step6'>6. Breeding
</a><br/>
<a href='/wiki/PredatorPrey_step7'>7. Agent Aspect
</a><br/>
<a href='/wiki/PredatorPrey_step8'>8. Complex Behavior
</a><br/>
<a href='/wiki/PredatorPrey_step9'>9. Stopping condition
</a><br/>
<a href='/wiki/PredatorPrey_step10'>10. Charts
</a><br/>
<a href='/wiki/PredatorPrey_step11'>11. Writing Files
</a><br/>
<a href='/wiki/PredatorPrey_step12'>12. Image loading
</a><br/>
    </div>
<a href='/wiki/RoadTrafficModel'>Road Traffic
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/RoadTrafficModel_step1'>1. Loading of GIS Data
</a><br/>
<a href='/wiki/RoadTrafficModel_step2'>2. People Agents
</a><br/>
<a href='/wiki/RoadTrafficModel_step3'>3. Movement of People
</a><br/>
<a href='/wiki/RoadTrafficModel_step4'>4. Weight for Road Network
</a><br/>
<a href='/wiki/RoadTrafficModel_step5'>5. Dynamic weights
</a><br/>
<a href='/wiki/RoadTrafficModel_step6'>6. Charts
</a><br/>
<a href='/wiki/RoadTrafficModel_step7'>7. Automatic Road Repair
</a><br/>
    </div>
<a href='/wiki/ThreeD'>3D Tutorial
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/ThreeD_step1'>1. Basic Model
</a><br/>
<a href='/wiki/ThreeD_step2'>2. Moving Cells
</a><br/>
<a href='/wiki/ThreeD_step3'>3. Connections
</a><br/>
    </div>
    </div>
    </div>
<a href='/wiki/References'>References
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/PlatformDocumentation'>Platform
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/InstallationAndLaunching'>Installation and Launching
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/Installation'>Installation
</a><br/>
<a href='/wiki/Launching'>Launching GAMA
</a><br/>
<a href='/wiki/Headless'>Headless Mode
</a><br/>
<a href='/wiki/Updating'>Updating GAMA
</a><br/>
<a href='/wiki/InstallingPlugins'>Installing Plugins
</a><br/>
<a href='/wiki/Troubleshooting'>Troubleshooting
</a><br/>
    </div>
<a href='/wiki/WorkspaceProjectsAndModels'>Workspace, Projects and Models
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/NavigatingWorkspace'>Navigating in the Workspace
</a><br/>
<a href='/wiki/ChangingWorkspace'>Changing Workspace
</a><br/>
<a href='/wiki/ImportingModels'>Importing Models
</a><br/>
    </div>
<a href='/wiki/EditingModels'>Editing models
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/GamlEditorGeneralities'>The GAML Editor - Generalities
</a><br/>
<a href='/wiki/GamlEditorToolbar'>The GAML Editor Toolbar
</a><br/>
<a href='/wiki/ValidationOfModels'>Validation of Models
</a><br/>
    </div>
<a href='/wiki/RunningExperiments'>Running Experiments
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/LaunchingExperiments'>Launching Experiments from the User Interface
</a><br/>
<a href='/wiki/ExperimentsUserInterface'>Experiments User Interface
</a><br/>
<a href='/wiki/MenusAndCommands'>Menus and Commands
</a><br/>
<a href='/wiki/ParametersView'>Parameters View
</a><br/>
<a href='/wiki/InspectorsAndMonitors'>Inspectors and monitors
</a><br/>
<a href='/wiki/Displays'>Displays
</a><br/>
<a href='/wiki/BatchSpecific'>Batch Specific UI
</a><br/>
<a href='/wiki/ErrorsView'>Errors View
</a><br/>
    </div>
<a href='/wiki/Preferences'>Preferences
</a><br/>
    </div>
<a href='/wiki/GamlReferences'>Gaml Reference
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/BuiltInSpecies'>Built-in Species
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/AgentBuiltIn'>The 'agent' built-in species (Under Construction)
</a><br/>
<a href='/wiki/ModelBuiltIn'>The 'model' built-in species (Under Construction)
</a><br/>
<a href='/wiki/ExperimentBuiltIn'>The 'experiment' built-in species (Under Construction)
</a><br/>
    </div>
<a href='/wiki/BuiltInSkills'>Built-in Skills
</a><br/>
<a href='/wiki/BuiltInArchitectures'>Built-in Architectures
</a><br/>
<a href='/wiki/Statements'>Statements
</a><br/>
<a href='/wiki/DataTypes'>Types
</a><br/>
<a href='/wiki/FileTypes'>File Types
</a><br/>
<a href='/wiki/Expressions'>Expressions
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/Literals'>Literals
</a><br/>
<a href='/wiki/UnitsAndConstants'>Units and constants
</a><br/>
<a href='/wiki/PseudoVariables'>Pseudo-variables
</a><br/>
<a href='/wiki/VariablesAndAttributes'>Variables and Attributes
</a><br/>
<a href='/wiki/Operators'>Operators 
</a><br/>
    </div>
    </div>
    </div>
Community
</div></div></nav></div>
    <div class="w3-threequarter">
        <h1 id="6-multi-level">6. Multi-Level</h1>
<p>This step Illustrates how to define a multi-level model</p>

<h2 id="formulation">Formulation</h2>
<p>We propose to let the buildings manage what happens when the people are inside buildings. In this context, we will use the multi-level properties of GAMA: when a people agent will be inside a building, it will be captured by it and its species will be modified. It will be not anymore the people agent that will decide when to leave the building, but the building itself.</p>

<p>We will need to:</p>
<ul>
  <li>define a micro-species of people inside the building species (<strong>people_in_buildings</strong>)</li>
  <li>define a new variable for the building agent (_people_in<strong>building</strong>)</li>
  <li>define two new behaviors for building: <strong>let_people_leave</strong> and <strong>let_people_enter</strong></li>
  <li>modify the aspect of the building</li>
  <li>modify some global variables for counting the number of infected people_</li>
</ul>

<p><img src="resources/images/tutorials/Incremental_model6.jpg" alt="images/Incremental_model6.jpg" /></p>

<h2 id="model-definition">Model Definition</h2>
<h3 id="building">building</h3>
<p>First, we define a new species called <strong>people_in_building</strong> inside the <strong>building</strong> species. Thus, a building could have agents of this species as <strong>members</strong> and control them. The <strong>people_in_building</strong> species has for parent the <strong>people</strong> species, which means that a <strong>people_in_building</strong> agent has all the properties, aspect and behaviors of a <strong>people</strong> agent.
In our case, we want the once a people agent inside a building, this people agent does nothing. Then, we use the <strong>schedules</strong> facet of the species to remove the <strong>people_in_building</strong> from the scheduler.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>species building {
	...
        species people_in_building parent: people schedules: [] {
	}
	...
}
</code></pre>
</div>

<p>We define a new dynamic variable for building agent: <strong>people_inside</strong> that will correspond to the list of <strong>people_in_building</strong> agents inside the building. Note that we use the syntax <strong>-&gt; {…}</strong> to make the variable dynamic. However, instead of <strong>update</strong> that allows a variable to be recomputed at each simulation step, the syntax <strong>-&gt; {…}</strong> allows the variable to be recomputed each time it is called (and thus avoid outdated problems). To compute this variable, we use the <strong>members</strong> built-in variable that corresponds to the list of micro-agents captured by the macro-agent.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>species building {
	...
        list&lt;people_in_building&gt; people_inside -&gt; {members collect people_in_building(each)};
	...
}
</code></pre>
</div>

<p>We define a first reflex for the buildings that will be activated at each simulation step and that will allow the building to capture all the people that are inside its geometry and that are not moving (target = nil). Capturing agents means putting them inside its <strong>members</strong> list and changing their species: here the <strong>people</strong> agents become <strong>people_in_building</strong> agents.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>species building {
	...
      reflex let_people_enter {
		list&lt;people&gt; entering_people &lt;- people inside self where (each.target = nil);
		if not (empty (entering_people)) {
			capture entering_people as: people_in_building ;
 		}
	}
        ....
}
</code></pre>
</div>

<p>We define a second reflex for the buildings that will be activated at each simulation step and that will allow the building to release some of the <strong>people_in_building</strong> agents. First, it increments the staying counter of all the <strong>people_in_building</strong> agents. Then it builds the list of leaving people by testing the same probability as before for all the <strong>people_in_building</strong> agents. Finally, if this list is not empty, it releases them as people agents (and gives them a new target point).</p>

<div class="highlighter-rouge"><pre class="highlight"><code>species building {
	...
       reflex let_people_leave  {
		ask members as: people_in_building{
			staying_counter &lt;- staying_counter + 1;
		}
		list&lt;people_in_building&gt; leaving_people &lt;- list&lt;people_in_building&gt;(members where (flip(people_in_building(each).staying_counter / staying_coeff)));
		if not (empty (leaving_people)) {
			release leaving_people as: people in: world returns: released_people;
			ask released_people {
				target &lt;- any_location_in (one_of(building));
			}
		}
	}
        ....
}
</code></pre>
</div>

<p>At last, we refine the aspect of the buildings: if there is not people inside the building, we draw it with gray color. If the number of <strong>people_in_building</strong> infected is higher than the number of <strong>people_in_building</strong> not infected, we draw it in red; otherwise in green.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>species building {
	...
        aspect geom {
	 	int nbI &lt;- members count people_in_building(each).is_infected;
		int nbT &lt;- length(members);
		draw shape color:nbT = 0 ? #gray : (float(nbI)/nbT &gt; 0.5 ? #red : #green) depth: height;
	}
}
</code></pre>
</div>

<h3 id="global-variables">global variables</h3>
<p>In order to take into account the people that are inside the buildings for the computation of <strong>nb_people_infected</strong>, we first build the list of <strong>people_in_building</strong>. As <strong>people_in_building</strong> is a macro species of <strong>building</strong>, we cannot compute it directly like for the other species, we then aggregate all the list <strong>people_inside</strong> of all building in a single list (<strong>list_people_in_buildings</strong>). Then, we compute the number of infected people as the number of people infected outside the building + the number of people infected inside them.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>global  {
	...
	list&lt;people_in_building&gt; list_people_in_buildings update: (building accumulate each.people_inside) where (not dead(each));
	int nb_people_infected &lt;- nb_infected_init update: people count (each.is_infected) + (empty(list_people_in_buildings) ? 0 : list_people_in_buildings count (each.is_infected));
        ...
}
</code></pre>
</div>

<h2 id="complete-model">Complete Model</h2>

<div class="highlighter-rouge"><pre class="highlight"><code> 
global  {
	int nb_people &lt;- 500;
	float step &lt;- 1 #minutes;
	float infection_distance &lt;- 2.0 #m;
	float proba_infection &lt;- 0.05;
	int nb_infected_init &lt;- 5;
	file roads_shapefile &lt;- file("../includes/road.shp");
	file buildings_shapefile &lt;- file("../includes/building.shp");
	geometry shape &lt;- envelope(roads_shapefile);
	graph road_network;
	int current_hour update: (cycle / 60) mod 24;
	float staying_coeff update: 10.0 ^ (1 + min([abs(current_hour - 9), abs(current_hour - 12), abs(current_hour - 18)]));
	
	list&lt;people_in_building&gt; list_people_in_buildings update: (building accumulate each.people_inside) where (not dead(each));
	int nb_people_infected &lt;- nb_infected_init update: people count (each.is_infected) + (empty(list_people_in_buildings) ? 0 : list_people_in_buildings count (each.is_infected));
	
	int nb_people_not_infected &lt;- nb_people - nb_infected_init update: nb_people - nb_people_infected;
	bool is_night &lt;- true update: current_hour &lt; 7 or current_hour &gt; 20;
	
	float infected_rate update: nb_people_infected/nb_people;
	init {
		create road from: roads_shapefile;
		road_network &lt;- as_edge_graph(road);
		create building from: buildings_shapefile;
		create people number:nb_people {
			speed &lt;- 5.0 #km/#h;
			building bd &lt;- one_of(building);
			location &lt;- any_location_in(bd);
		}
		ask nb_infected_init among people {
			is_infected &lt;- true;
		}
		
	}
	reflex end_simulation when: infected_rate = 1.0 {		
		do halt;
	}
}

species people skills:[moving]{		
	bool is_infected &lt;- false;
	point target;
	int staying_counter;
		
	reflex move when: target != nil{
		do goto target:target on: road_network;
		if (location = target) {
			target &lt;- any_location_in (one_of(building));
			target &lt;- nil;
			staying_counter &lt;- 0;
		} 
	}
	reflex infect when: is_infected{
		ask people at_distance infection_distance {
			if flip(proba_infection) {
				is_infected &lt;- true;
			}
		}
	}
	aspect circle{
		draw circle(5) color:is_infected ? #red : #green;
	}
	aspect sphere3D{
		draw sphere(3) at: {location.x,location.y,location.z + 3} color:is_infected ? #red : #green;
	}
}

species road {
	geometry display_shape &lt;- shape + 2.0;
	aspect geom {
		draw display_shape color: #black depth: 3.0;
	}
}

species building {
	float height &lt;- 10#m + rnd(10) #m;
	list&lt;people_in_building&gt; people_inside -&gt; {members collect people_in_building(each)};
	
	aspect geom {
		int nbI &lt;- members count people_in_building(each).is_infected;
		int nbT &lt;- length(members);
		draw shape color:nbT = 0 ? #gray : (float(nbI)/nbT &gt; 0.5 ? #red : #green) depth: height;
	}
	
	species people_in_building parent: people schedules: [] {
		aspect circle{}
		aspect sphere3D{}
	}
	
	species people_in_2 parent: people schedules: [] {
		aspect circle{}
		aspect sphere3D{}
	}
	
	reflex let_people_leave  {
		ask members as: people_in_building{
			staying_counter &lt;- staying_counter + 1;
		}
		list&lt;people_in_building&gt; leaving_people &lt;- list&lt;people_in_building&gt;(members where (flip(people_in_building(each).staying_counter / staying_coeff)));
		if not (empty (leaving_people)) {
			release leaving_people as: people in: world returns: released_people;
			ask released_people {
				target &lt;- any_location_in (one_of(building));
			}
		}
	}
	reflex let_people_enter {
		list&lt;people&gt; entering_people &lt;- people inside self where (each.target = nil);
		if not (empty (entering_people)) {
			capture entering_people as: people_in_building ;
 		}
	}
}

experiment main_experiment type:gui{
	parameter "Infection distance" var: infection_distance;
	parameter "Proba infection" var: proba_infection min: 0.0 max: 1.0;
	parameter "Nb people infected at init" var: nb_infected_init ;
	output {
		monitor "Current hour" value: current_hour;
		monitor "Infected people rate" value: infected_rate;
		display map_3D type: opengl {
			light 1 color:(is_night ? 50 : 255);
			image "../includes/soil.jpg";
			species road aspect:geom;
			species people aspect:sphere3D;			
			species building aspect:geom transparency: 0.5;
		}
		display chart refresh:every(10) {
			chart "Disease spreading" type: series {
				data "susceptible" value: nb_people_not_infected color: #green;
				data "infected" value: nb_people_infected color: #red;
			}
		}
	}
}
</code></pre>
</div>

    </div>
    </div>
    </div>
    </body></html>
