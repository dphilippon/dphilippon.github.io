
    <!doctype html><html lang="en"><head><meta charset="utf-8"><title>Using Equations</title></head>
    <body>
    <link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/w3.css">
<link rel="stylesheet" href="/css/font-awesome.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="//connect.facebook.net/en_US/all.js"></script>
<script src="/js/linkify.min.js"></script>
<script src="/js/linkify-jquery.min.js"></script>
<script src="https://unpkg.com/lunr/lunr.js"></script>
    <div class="w3-bar w3-white w3-hide-small">
      <a href="/" class="w3-bar-item w3-button"><img src="/images/icon_gama_50.png"></a>
      <a href="/wiki/Home" class="w3-bar-item w3-button w3-text-blue">Documentation</a>
      <a href="/wiki/Tutorials" class="w3-bar-item w3-button w3-text-blue">Tutorials</a>
      <a href="/download" class="w3-bar-item w3-button w3-text-blue">Download</a>
      <a href="/news" class="w3-bar-item w3-button w3-text-blue">News</a>
      <a href="/contribute" class="w3-bar-item w3-button w3-text-blue">Contribute</a>
    </div>

    <div class="w3-row-padding w3-padding-64 w3-container">
        <div>
             <div class="w3-quarter" style="width:260px">
		<nav class="w3-bar-block w3-collapse w3-large w3-theme-l5 w3-animate-left w3-small"  style="z-index:3;margin-left:10px" id="mySidebar">
                    <div class="w3-medium w3-text-blue" style="font-weight:bold"><div>
<a href='/wiki/Tutorials'>Tutorials
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/LearnGAMLStepByStep'>Learn GAML Step by Step
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/Introduction'>Introduction
</a><br/>
<a href='/wiki/StartWithGAML'>Start with GAML
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/ModelOrganization'>Organization of a model
</a><br/>
<a href='/wiki/BasicProgrammingConceptsInGAML'>Basic programming concepts in GAML
</a><br/>
    </div>
<a href='/wiki/ManipulateBasicSpecies'>Manipulate basic species
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/GlobalSpecies'>The global species
</a><br/>
<a href='/wiki/RegularSpecies'>Regular species
</a><br/>
<a href='/wiki/DefiningActionsAndBehaviors'>Defining actions and behaviors
</a><br/>
<a href='/wiki/InteractionBetweenAgents'>Interaction between agents
</a><br/>
<a href='/wiki/AttachingSkills'>Attaching Skills
</a><br/>
<a href='/wiki/Inheritance'>Inheritance
</a><br/>
    </div>
<a href='/wiki/DefiningAdvancedSpecies'>Defining advanced species
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/GridSpecies'>Grid Species
</a><br/>
<a href='/wiki/GraphSpecies'>Graph Species
</a><br/>
<a href='/wiki/MirrorSpecies'>Mirror species
</a><br/>
<a href='/wiki/MultiLevelArchitecture'>Multi-level architecture
</a><br/>
    </div>
<a href='/wiki/DefiningGUIExperiment'>Defining GUI Experiment
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/DefiningParameters'>Defining Parameters
</a><br/>
<a href='/wiki/DefiningDisplaysGeneralities'>Defining displays (Generalities)
</a><br/>
<a href='/wiki/DefiningCharts'>Defining Charts
</a><br/>
<a href='/wiki/Defining3DDisplays'>Defining 3D Displays
</a><br/>
<a href='/wiki/DefiningMonitorsAndInspectors'>Defining monitors and inspectors
</a><br/>
<a href='/wiki/DefiningExportFiles'>Defining export files
</a><br/>
<a href='/wiki/DefiningUserInteraction'>Defining user interaction
</a><br/>
    </div>
<a href='/wiki/ExploringModels'>Exploring Models
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/RunSeveralSimulations'>Run Several Simulations
</a><br/>
<a href='/wiki/BatchExperiments'>Defining Batch Experiments
</a><br/>
<a href='/wiki/ExplorationMethods'>Exploration Methods
</a><br/>
    </div>
<a href='/wiki/OptimizingModels'>Optimizing Models
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/RuntimeConcepts'>Runtime Concepts
</a><br/>
OptimizingModelsSelection
    </div>
<a href='/wiki/MultiParadigmModeling'>Multi-Paradigm Modeling
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/ControlArchitecture'>Control Architectures
</a><br/>
<a href='/wiki/Equations'>Using Equations
</a><br/>
    </div>
    </div>
<a href='/wiki/Recipes'>Recipes
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/ManipulateOSMDatas'>Manipulate OSM Datas
</a><br/>
<a href='/wiki/Diffusion'>Implementing diffusion
</a><br/>
<a href='/wiki/UsingDatabase'>Using Database Access
</a><br/>
<a href='/wiki/CallingR'>Calling R
</a><br/>
<a href='/wiki/UsingFIPAACL'>Using FIPA ACL
</a><br/>
<a href='/wiki/GamAnalyzer'>Using GAMAnalyzer
</a><br/>
<a href='/wiki/UsingBDI'>Using BDI
</a><br/>
<a href='/wiki/UsingDrivingSkill'>Advanced Driving Skill
</a><br/>
<a href='/wiki/ManipulateDates'>Manipulate Dates
</a><br/>
<a href='/wiki/ManipulateLight'>Implementing light
</a><br/>
<a href='/wiki/Comodel'>Using Comodel
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
â€”Headlessmodefordummies
    </div>
    </div>
    </div>
<a href='/wiki/Tutorials'>Tutorials
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/LuneraysFlu'>Luneray's flu
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/LuneraysFlu_step1'>1. Creation of a first basic disease spreading model
</a><br/>
<a href='/wiki/LuneraysFlu_step2'>2. Definition of monitors and chart outputs
</a><br/>
<a href='/wiki/LuneraysFlu_step3'>3. Importation of GIS data
</a><br/>
<a href='/wiki/LuneraysFlu_step4'>4. Use of a graph to constraint the movements of people]
</a><br/>
<a href='/wiki/LuneraysFlu_step5'>5. Definition of 3D displays
</a><br/>
    </div>
<a href='/wiki/IncrementalModel'>Incremental Model
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/IncrementalModel_step1'>1. Simple SI Model
</a><br/>
<a href='/wiki/IncrementalModel_step2'>2. Charts
</a><br/>
<a href='/wiki/IncrementalModel_step3'>3. Integration of GIS Data
</a><br/>
<a href='/wiki/IncrementalModel_step4'>4. Movement on Graph
</a><br/>
<a href='/wiki/IncrementalModel_step5'>5. Visualizing in 3D
</a><br/>
<a href='/wiki/IncrementalModel_step6'>6. Multi-Level
</a><br/>
<a href='/wiki/IncrementalModel_step7'>7. Differential Equations
</a><br/>
    </div>
<a href='/wiki/PredatorPrey'>Predator Prey
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/PredatorPrey_step1'>1. Basic Model
</a><br/>
<a href='/wiki/PredatorPrey_step2'>2. Vegetation Dynamic
</a><br/>
<a href='/wiki/PredatorPrey_step3'>3. Prey Agent Behavior
</a><br/>
<a href='/wiki/PredatorPrey_step4'>4. Inspectors and Monitors
</a><br/>
<a href='/wiki/PredatorPrey_step5'>5. Predator Agent
</a><br/>
<a href='/wiki/PredatorPrey_step6'>6. Breeding
</a><br/>
<a href='/wiki/PredatorPrey_step7'>7. Agent Aspect
</a><br/>
<a href='/wiki/PredatorPrey_step8'>8. Complex Behavior
</a><br/>
<a href='/wiki/PredatorPrey_step9'>9. Stopping condition
</a><br/>
<a href='/wiki/PredatorPrey_step10'>10. Charts
</a><br/>
<a href='/wiki/PredatorPrey_step11'>11. Writing Files
</a><br/>
<a href='/wiki/PredatorPrey_step12'>12. Image loading
</a><br/>
    </div>
<a href='/wiki/RoadTrafficModel'>Road Traffic
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/RoadTrafficModel_step1'>1. Loading of GIS Data
</a><br/>
<a href='/wiki/RoadTrafficModel_step2'>2. People Agents
</a><br/>
<a href='/wiki/RoadTrafficModel_step3'>3. Movement of People
</a><br/>
<a href='/wiki/RoadTrafficModel_step4'>4. Weight for Road Network
</a><br/>
<a href='/wiki/RoadTrafficModel_step5'>5. Dynamic weights
</a><br/>
<a href='/wiki/RoadTrafficModel_step6'>6. Charts
</a><br/>
<a href='/wiki/RoadTrafficModel_step7'>7. Automatic Road Repair
</a><br/>
    </div>
<a href='/wiki/ThreeD'>3D Tutorial
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/ThreeD_step1'>1. Basic Model
</a><br/>
<a href='/wiki/ThreeD_step2'>2. Moving Cells
</a><br/>
<a href='/wiki/ThreeD_step3'>3. Connections
</a><br/>
    </div>
    </div>
    </div>
<a href='/wiki/References'>References
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/PlatformDocumentation'>Platform
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/InstallationAndLaunching'>Installation and Launching
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/Installation'>Installation
</a><br/>
<a href='/wiki/Launching'>Launching GAMA
</a><br/>
<a href='/wiki/Headless'>Headless Mode
</a><br/>
<a href='/wiki/Updating'>Updating GAMA
</a><br/>
<a href='/wiki/InstallingPlugins'>Installing Plugins
</a><br/>
<a href='/wiki/Troubleshooting'>Troubleshooting
</a><br/>
    </div>
<a href='/wiki/WorkspaceProjectsAndModels'>Workspace, Projects and Models
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/NavigatingWorkspace'>Navigating in the Workspace
</a><br/>
<a href='/wiki/ChangingWorkspace'>Changing Workspace
</a><br/>
<a href='/wiki/ImportingModels'>Importing Models
</a><br/>
    </div>
<a href='/wiki/EditingModels'>Editing models
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/GamlEditorGeneralities'>The GAML Editor - Generalities
</a><br/>
<a href='/wiki/GamlEditorToolbar'>The GAML Editor Toolbar
</a><br/>
<a href='/wiki/ValidationOfModels'>Validation of Models
</a><br/>
    </div>
<a href='/wiki/RunningExperiments'>Running Experiments
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/LaunchingExperiments'>Launching Experiments from the User Interface
</a><br/>
<a href='/wiki/ExperimentsUserInterface'>Experiments User Interface
</a><br/>
<a href='/wiki/MenusAndCommands'>Menus and Commands
</a><br/>
<a href='/wiki/ParametersView'>Parameters View
</a><br/>
<a href='/wiki/InspectorsAndMonitors'>Inspectors and monitors
</a><br/>
<a href='/wiki/Displays'>Displays
</a><br/>
<a href='/wiki/BatchSpecific'>Batch Specific UI
</a><br/>
<a href='/wiki/ErrorsView'>Errors View
</a><br/>
    </div>
<a href='/wiki/Preferences'>Preferences
</a><br/>
    </div>
<a href='/wiki/GamlReferences'>Gaml Reference
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/BuiltInSpecies'>Built-in Species
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/AgentBuiltIn'>The 'agent' built-in species (Under Construction)
</a><br/>
<a href='/wiki/ModelBuiltIn'>The 'model' built-in species (Under Construction)
</a><br/>
<a href='/wiki/ExperimentBuiltIn'>The 'experiment' built-in species (Under Construction)
</a><br/>
    </div>
<a href='/wiki/BuiltInSkills'>Built-in Skills
</a><br/>
<a href='/wiki/BuiltInArchitectures'>Built-in Architectures
</a><br/>
<a href='/wiki/Statements'>Statements
</a><br/>
<a href='/wiki/DataTypes'>Types
</a><br/>
<a href='/wiki/FileTypes'>File Types
</a><br/>
<a href='/wiki/Expressions'>Expressions
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/Literals'>Literals
</a><br/>
<a href='/wiki/UnitsAndConstants'>Units and constants
</a><br/>
<a href='/wiki/PseudoVariables'>Pseudo-variables
</a><br/>
<a href='/wiki/VariablesAndAttributes'>Variables and Attributes
</a><br/>
<a href='/wiki/Operators'>Operators 
</a><br/>
    </div>
    </div>
    </div>
Community
</div></div></nav></div>
    <div class="w3-threequarter">
        <h1 id="using-equations">Using Equations</h1>

<h2 id="introduction">Introduction</h2>

<p>ODEs (Ordinary Differential Equations) are often used in ecology or in epidemiology to describe the macroscopic evolution over time of a population. Generally the whole population is split into several compartments. The state of the population is described by the number of individuals in each compartment. Each equation of the ODE system describes the evolution of the number of individual in a compartment. In such an approach individuals are not taken into account individually, with own features and behaviors. In contrary they are aggregated in a compartment and reduced to a number.</p>

<p>A classical example is the SIR epidemic model representing the spreading of a disease in a population. The population is split into 3 compartments: S (Susceptible), I (Infected), R (Recovered). (see below for the equation)</p>

<p>In general the ODE systems cannot be analytically solved, i.e. it is not possible to find the equation describing the evolution of the number of S, I or R. But these systems can be numerically integrated in order to get the evolution. A numerical integration computes step after step the value of S, I and R. Several integration methods exist (e.g. Euler, Runge-Kuttaâ€¦), each of them being a compromise between accuracy and computation time. The length of the integration step has also a huge impact on precision. These models are deterministic.</p>

<p>This approach makes a lot of strong hypotheses. The model does not take into account space. The population is considered has infinite and homogeneously mixed, so that any agent can interact with any other one.</p>

<h2 id="example-of-a-sir-model">Example of a SIR model</h2>

<p>In the SIR model, the population is split into 3 compartments: S (Susceptible), I (Infected), R (Recovered). This can be represented by the following Forrester diagram: boxes represent stocks (i.e. compartments) and arrows are flows. Arrows hold the rate of a compartment population flowing to another compartment.</p>

<p><img src="resources/images/multiParadigmModeling/SIR-compartment.png" alt="SIR-compartment.png" /></p>

<p>The corresponding ODE system contains one equation per stock. For example, the I compartment evolution is influenced by an inner (so positive) flow from the S compartment and an outer (so negative) flow to the R compartment.</p>

<p><img src="resources/images/multiParadigmModeling/SIR-equations.png" alt="SIR-equations.png" /></p>

<p>Integrating this system using the Runge-Kutta 4 method provides the evolution of S, I and R over time. The initial values are:</p>
<ul>
  <li>S = 499</li>
  <li>I = 1</li>
  <li>R = 0</li>
  <li>beta = 0.4</li>
  <li>gamma = 0.1</li>
  <li>h = 0.1</li>
</ul>

<p><img src="resources/images/multiParadigmModeling/SIR-result.png" alt="SIR-result.png" /></p>

<h2 id="why-and-when-can-we-use-ode-in-agent-based-models-">Why and when can we use ODE in agent-based models ?</h2>

<p>These hypotheses are very strong and cannot be fulfilled in agent-based models.</p>

<p>But in some multi-scale models, some entities can be close. For example if we want to implement a model describing the worldwide epidemic spread and the impact of air traffic on it, we cannot simulate the 7 billions people. But we can represent only cities with airports and airplanes as agents. In this case, cities are entities with a population of millions inhabitants, that will not been spatially located. As we are only interested in the disease spread, we are only interested in the number of infected people in the cities (and susceptibles and recovered too). As a consequence, it appears particularly relevant to describe the evolution of the disease in the city using a ODE system.</p>

<p>In addition these models have the advantage to not be sensible to population size in the integration process. Dozens or billions people does not bring a computation time increase, contrarily to agent-based models.</p>

<h2 id="use-of-ode-in-a-gaml-model">Use of ODE in a GAML model</h2>

<p>A stereotypical use of ODE in a GAMA agent-based model is to describe species where some agents attributes evolution is described using an ODE system.</p>

<p>As a consequence, the GAML language has been increased by two main concepts (as two statements):</p>
<ul>
  <li>equations can be written with the <code class="highlighter-rouge">equation</code> statement. An <code class="highlighter-rouge">equation</code> block is composed of a set of <code class="highlighter-rouge">diff</code> statement describing the evolution of species attributes.</li>
  <li>an equation can be numerically integrated using the <code class="highlighter-rouge">solve</code> statement</li>
</ul>

<h2 id="equation"><code class="highlighter-rouge">equation</code></h2>
<h3 id="defining-an-ode-system">Defining an ODE system</h3>
<p>Defining a new ODE system needs to define a new <code class="highlighter-rouge">equation</code> block in a species. As example, the following <code class="highlighter-rouge">eqSI</code> system describes the evolution of a population with 2 compartments (S and I) and the flow from S to I compartment:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>species userSI {
	float t ;
	float I ; 
	float S ; 
	int N ;
	float beta&lt;-0.4 ;
	float h ;
	
	equation eqSI {
		diff(S,t) = -beta * S * I / N ;
		diff(I,t) = beta * S * I / N ;
	}
}			
</code></pre>
</div>
<p>This equation has to be defined in a species with <code class="highlighter-rouge">t</code>, <code class="highlighter-rouge">S</code> and <code class="highlighter-rouge">I</code> attributes. <code class="highlighter-rouge">beta</code> (and other similar parameters) can be defined either in the specific species (if it is specific to each agents) or in the <code class="highlighter-rouge">global</code> if it is a constant.</p>

<p>Note: the <code class="highlighter-rouge">t</code> attribute will be automatically updated using the <code class="highlighter-rouge">solve</code> statement ; it contains the time elapsed in the equation integration.</p>

<h3 id="using-a-built-in-ode-system">Using a built-in ODE system</h3>
<p>In order to ease the use of very classical ODE system, some built-in systems have been implemented in GAMA. For example, the previous SI system can be written as follows. Three additional facets are used to define the system:</p>
<ul>
  <li><code class="highlighter-rouge">type</code>: the identifier of the built-in system (here SI) (the list of all built-in systems are described below),</li>
  <li><code class="highlighter-rouge">vars</code>: this facet is expecting a list of variables of the species, that will be matched with the variables of the system,</li>
  <li><code class="highlighter-rouge">params</code>: this facet is expecting a list of variables of the species (of of the global), that will be matched with the parameters of the system.
    <div class="highlighter-rouge"><pre class="highlight"><code>equation eqBuiltInSI type: SI vars: [S,I,t] params: [N,beta] ;
</code></pre>
    </div>
  </li>
</ul>

<h3 id="split-a-system-into-several-agents">Split a system into several agents</h3>

<p>An equation system can be split into several species and each part of the system are synchronized using the <code class="highlighter-rouge">simultaneously</code> facet of <code class="highlighter-rouge">equation</code>. The system split into several agents can be integrated using a single call to the <code class="highlighter-rouge">solve</code> statement. Notice that all the <code class="highlighter-rouge">equation</code> definition must have the same name.</p>

<p>For example the SI system presented above can be defined in two different species <code class="highlighter-rouge">S_agt</code> (containing the equation defining the evolution of the S value) and <code class="highlighter-rouge">I_agt</code> (containing the equation defining the evolution of the I value). These two equations are linked using the <code class="highlighter-rouge">simultaneously</code> facet of the <code class="highlighter-rouge">equation</code> statement. This facet expects a set of agents. The integration is called only once in a simulation step, e.g. in the <code class="highlighter-rouge">S_agt</code> agent.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>species S_agt {
	float t ;		
	float Ssize ;
	
	equation evol simultaneously: [ I_agt ] {
		diff(Ssize, t) = (- sum(I_agt accumulate [each.beta * each.Isize]) * self.Ssize / N);
	}
	
	reflex solving {solve evol method : rk4 step : hKR4 ;}	
}

species I_agt {
	float t ;
	float Isize ; // number of infected	
	float beta ;

	equation evol simultaneously : [ S_agt ] {
		diff(Isize, t) = (beta * first(S_agt).Ssize * Isize / N);
	}
}
</code></pre>
</div>
<p>The interest is that the modeler can create several agents for each compartment, which different values. For example in the SI model, the modeler can choose to create 1 agent <code class="highlighter-rouge">S_agt</code> and 2 agents <code class="highlighter-rouge">I_agt</code>. The <code class="highlighter-rouge">beta</code> attribute will have different values in the two agents, in order to represent 2 different strains.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>global {
	int number_S &lt;- 495 ; // The number of susceptible
	int number_I &lt;- 5   ; // The number of infected
	int nb_I &lt;- 2;
	float gbeta  &lt;- 0.3  ; // The parameter Beta
	
	int N &lt;- number_S + nb_I * number_I ;
	float hKR4 &lt;- 0.1 ;

	init {
		create S_agt {
			Ssize &lt;- float(number_S) ;
		}
		create I_agt number: nb_I {
			Isize &lt;- float(number_I) ;
			self.beta &lt;- myself.gbeta + rnd(0.5) ;
		}
	}
}
</code></pre>
</div>

<p>The results are computed using the RK4 method with:</p>
<ul>
  <li>number_S = 495</li>
  <li>number_I = 5</li>
  <li>nb_I = 2</li>
  <li>gbeta = 0.3</li>
  <li>hKR4 = 0.1</li>
</ul>

<p><img src="resources/images/multiParadigmModeling/SI-split-results.png" alt="SI-split-results.png" /></p>

<h2 id="solve-an-equation"><code class="highlighter-rouge">solve</code> an equation</h2>
<p>The <code class="highlighter-rouge">solve</code> statement has been added in order to integrate numerically the equation system. It should be add into a reflex. At each simulation step, a step of the integration is executed, the length of the integration step is defined in the <code class="highlighter-rouge">step</code> facet. The <code class="highlighter-rouge">solve</code> statement will update the variables used in the equation system. The chosen integration method (defined in <code class="highlighter-rouge">method</code>) is Runge-Kutta 4 (which is very often a good choice of integration method in terms of accuracy).</p>
<div class="highlighter-rouge"><pre class="highlight"><code>reflex solving {
	solve eqSI method:rk4 step:h;
}
</code></pre>
</div>
<p>With a smaller integration step, the integration will be faster but less accurate.</p>

<h2 id="more-details">More details</h2>

<h3 id="details-about-the-solve-statement">Details about the <code class="highlighter-rouge">solve</code> statement</h3>

<p>The <code class="highlighter-rouge">solve</code> statement can have a huge set of facets (see [S_Statements#solve] for more details). The basic use of the <code class="highlighter-rouge">solve</code> statement requiers only the equation identifier. By default, the integration method is Runge-Kutta 4 with an integration step of <code class="highlighter-rouge">1</code>, which means that at each simulation step the equation integration is made over 1 unit of time (which is implicitly defined by the system parameter value).</p>

<div class="highlighter-rouge"><pre class="highlight"><code>solve eqSI ;
</code></pre>
</div>

<p>2 integration methods can be used:</p>
<ul>
  <li><code class="highlighter-rouge">method: rk4</code> will use <a href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods">the Runge-Kutta 4 integration method</a></li>
  <li><code class="highlighter-rouge">method: dp853</code> will use <a href="https://en.wikipedia.org/wiki/Dormand%E2%80%93Prince_method">the Dorman-Prince 8(5,3) integration method</a>. The advantage of this method compared to Runge-Kutta is that it has an evaluation of the error and can use it to adapt the integration step size.</li>
</ul>

<p>In order to synchronize the simulation step and the equation integration step, 2 facets can be used:</p>
<ul>
  <li><code class="highlighter-rouge">step: number</code></li>
  <li><code class="highlighter-rouge">cycle_length: number</code></li>
</ul>

<p>cycle_length (int): length of simulation cycle which will be synchronize with step of integrator (default value: 1)
step (float): integration step, use with most integrator methods (default value: 1)</p>

<p>time_final (float): target time for the integration (can be set to a value smaller than t0 for backward integration)
time_initial (float): initial time
discretizing_step (int): number of discret beside 2 step of simulation (default value: 0)
integrated_times (list): time interval inside integration process
integrated_values (list): list of variablesâ€™s value inside integration process</p>

<p>Some facets are specific to the DP853 integration methods: <code class="highlighter-rouge">max_step</code>, <code class="highlighter-rouge">min_step</code>, <code class="highlighter-rouge">scalAbsoluteTolerance</code> and <code class="highlighter-rouge">scalRelativeTolerance</code>.</p>

<h3 id="example-of-the-influence-of-the-integration-step">Example of the influence of the integration step</h3>

<p>The <code class="highlighter-rouge">step</code> and <code class="highlighter-rouge">cycle_length</code> facets of the integration method may have a huge influence on the results. <code class="highlighter-rouge">step</code> has an impact on the result accuracy. In addition, it is possible to synchronize the step of the (agent-based) simulation and the (equation) integration step in various ways (depending on the modeler purpose) using the <code class="highlighter-rouge">cycle_length</code> facet: e.g. <code class="highlighter-rouge">cycle_length: 10</code> means that 10 simulation steps are equivalent to 1 unit of time of the integration method.</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">solve SIR method: "rk4" step: 1.0 cycle_length: 1.0 ; </code>
<img src="resources/images/multiParadigmModeling/SIR-results-h1.png" alt="SIR-results-h1.png" /></p>
  </li>
  <li>
    <p><code class="highlighter-rouge">solve SIR method: "rk4" step: 0.1 cycle_length: 10.0 ; </code>
<img src="resources/images/multiParadigmModeling/SIR-results-h0.1.png" alt="SIR-results-h0.1.png" /></p>
  </li>
  <li>
    <p><code class="highlighter-rouge">solve SIR method: "rk4" step: 0.01 cycle_length: 100.0 ; </code>
<img src="resources/images/multiParadigmModeling/SIR-results-h0.01.png" alt="SIR-results-h0.01.png" /></p>
  </li>
</ul>

<h3 id="list-of-built-in-ode-systems">List of built-in ODE systems</h3>
<p>Several built-in equations have been defined.</p>
<h4 id="equation-eqbuiltinsi-type-si-vars-sit-params-nbeta"><code class="highlighter-rouge">equation eqBuiltInSI type: SI vars: [S,I,t] params: [N,beta];</code></h4>

<p>This system is equivalent to:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>equation eqSI {
	diff(S,t) = -beta * S * I / N ;
	diff(I,t) = beta * S * I / N ;
}
</code></pre>
</div>

<p><img src="resources/images/multiParadigmModeling/SI-compartment.png" alt="SI-compartment.png" /></p>

<p><img src="resources/images/multiParadigmModeling/SI-equations.png" alt="SI-equations.png" /></p>

<p>The results are provided using the Runge-Kutta 4 method using following initial values:</p>
<ul>
  <li>S = 499</li>
  <li>I = 1</li>
  <li>beta = 0.4</li>
  <li>h = 0.1</li>
</ul>

<p><img src="resources/images/multiParadigmModeling/SI-result.png" alt="SI-result.png" /></p>

<h4 id="equation-eqsis-type-sis-vars-sit-params-nbetagamma"><code class="highlighter-rouge">equation eqSIS type: SIS vars: [S,I,t] params: [N,beta,gamma];</code></h4>

<p>This system is equivalent to:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>equation eqSIS {
	diff(S,t) = -beta * S * I / N + gamma * I;
	diff(I,t) = beta * S * I / N - gamma * I;
}
</code></pre>
</div>
<p><img src="resources/images/multiParadigmModeling//SIS-compartment.png" alt="SIS-compartment.png" /></p>

<p><img src="resources/images/multiParadigmModeling/SIS-equations.png" alt="SIS-equations.png" /></p>

<p>The results are provided using the Runge-Kutta 4 method using following initial values:</p>
<ul>
  <li>S = 499</li>
  <li>I = 1</li>
  <li>beta = 0.4</li>
  <li>gamma = 0.1</li>
  <li>h = 0.1</li>
</ul>

<p><img src="resources/images/multiParadigmModeling/SIS-result.png" alt="SIS-result.png" /></p>

<h4 id="equation-eqsir-typesir-varssirt-paramsnbetagamma-"><code class="highlighter-rouge">equation eqSIR type:SIR vars:[S,I,R,t] params:[N,beta,gamma] ;</code></h4>

<p>This system is equivalent to:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>equation eqSIR {
	diff(S,t) = (- beta * S * I / N);
	diff(I,t) = (beta * S * I / N) - (gamma * I);
	diff(R,t) = (gamma * I);
}
</code></pre>
</div>

<p><img src="resources/images/multiParadigmModeling/SIR-compartment.png" alt="SIR-compartment.png" /></p>

<p><img src="resources/images/multiParadigmModeling/SIR-equations.png" alt="SIR-equations.png" /></p>

<p>The results are provided using the Runge-Kutta 4 method using following initial values:</p>
<ul>
  <li>S = 499</li>
  <li>I = 1</li>
  <li>R = 0</li>
  <li>beta = 0.4</li>
  <li>gamma = 0.1</li>
  <li>h = 0.1</li>
</ul>

<p><img src="resources/images/multiParadigmModeling/SIR-result.png" alt="SIR-result.png" /></p>

<h4 id="equation-eqsirs-type-sirs-vars-sirt-params-nbetagammaomegamu-"><code class="highlighter-rouge">equation eqSIRS type: SIRS vars: [S,I,R,t] params: [N,beta,gamma,omega,mu] ;</code></h4>

<p>This system is equivalent to:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>equation eqSIRS {
	 diff(S,t) = mu * N + omega * R + - beta * S * I / N - mu * S ;
	 diff(I,t) = beta * S * I / N - gamma * I - mu * I ;
	 diff(R,t) = gamma * I - omega * R - mu * R ;
}
</code></pre>
</div>

<p><img src="resources/images/multiParadigmModeling/SIRS-compartment.png" alt="SIRS-compartment.png" /></p>

<p><img src="resources/images/multiParadigmModeling/SIRS-equations.png" alt="SIRS-equations.png" /></p>

<p>The results are provided using the Runge-Kutta 4 method using following initial values:</p>
<ul>
  <li>S = 499</li>
  <li>I = 1</li>
  <li>R = 0</li>
  <li>beta = 0.4</li>
  <li>gamma = 0.01</li>
  <li>omega = 0.05</li>
  <li>mu = 0.01</li>
  <li>h = 0.1</li>
</ul>

<p><img src="resources/images/multiParadigmModeling/SIRS-result.png" alt="SIRS-result.png" /></p>

<h4 id="equation-eqseir-type-seir-vars-seirt-params-nbetagammasigmamu-"><code class="highlighter-rouge">equation eqSEIR type: SEIR vars: [S,E,I,R,t] params: [N,beta,gamma,sigma,mu] ;</code></h4>

<p>This system is equivalent to:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>equation eqSEIR {
	diff(S,t) = mu * N - beta * S * I / N - mu * S ;
	diff(E,t) = beta * S * I / N - mu * E - sigma * E ;
	diff(I,t) = sigma * E - mu * I - gamma * I;
	diff(R,t) = gamma * I - mu * R ;
}
</code></pre>
</div>

<p><img src="resources/images/multiParadigmModeling/SEIR-compartment.png" alt="SEIR-compartment.png" /></p>

<p><img src="resources/images/multiParadigmModeling/SEIR-equations.png" alt="SEIR-equations.png" /></p>

<p>The results are provided using the Runge-Kutta 4 method using following initial values:</p>
<ul>
  <li>S = 499</li>
  <li>E = 0</li>
  <li>I = 1</li>
  <li>R = 0</li>
  <li>beta = 0.4</li>
  <li>gamma = 0.01</li>
  <li>sigma = 0.05</li>
  <li>mu = 0.01</li>
  <li>h = 0.1</li>
</ul>

<p><img src="resources/images/multiParadigmModeling/SEIR-result.png" alt="SEIR-result.png" /></p>

<h4 id="equation-eqlv-type-lv-vars-xyt-params-alphabetadeltagamma-"><code class="highlighter-rouge">equation eqLV type: LV vars: [x,y,t] params: [alpha,beta,delta,gamma] ;</code></h4>

<p>This system is equivalent to:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>equation eqLV { 
	diff(x,t) =   x * (alpha - beta * y);
	diff(y,t) = - y * (delta - gamma * x);
}	
</code></pre>
</div>

<p><img src="resources/images/multiParadigmModeling/LV-equations.png" alt="LV-equations.png" /></p>

<p>The results are provided using the Runge-Kutta 4 method using following initial values:</p>
<ul>
  <li>x = 2</li>
  <li>y = 2</li>
  <li>alpha = 0.8</li>
  <li>beta = 0.3</li>
  <li>gamma = 0.2</li>
  <li>delta = 0.85</li>
  <li>h = 0.1</li>
</ul>

<p><img src="resources/images/multiParadigmModeling/LV-result.png" alt="LV-result.png" />
<a href="# (endConcept|concept_math)">//</a>: # (endConcept|equation)</p>

    </div>
    </div>
    </div>
    </body></html>
