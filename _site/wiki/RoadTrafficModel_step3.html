
    <!doctype html><html lang="en"><head><meta charset="utf-8"><title>3. Movement of People</title></head>
    <body>
    <link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/w3.css">
<link rel="stylesheet" href="/css/font-awesome.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="//connect.facebook.net/en_US/all.js"></script>
<script src="/js/linkify.min.js"></script>
<script src="/js/linkify-jquery.min.js"></script>
<script src="https://unpkg.com/lunr/lunr.js"></script>
    <div class="w3-bar w3-white w3-hide-small">
      <a href="/" class="w3-bar-item w3-button"><img src="/images/icon_gama_50.png"></a>
      <a href="/wiki/Home" class="w3-bar-item w3-button w3-text-blue">Documentation</a>
      <a href="/wiki/Tutorials" class="w3-bar-item w3-button w3-text-blue">Tutorials</a>
      <a href="/download" class="w3-bar-item w3-button w3-text-blue">Download</a>
      <a href="/news" class="w3-bar-item w3-button w3-text-blue">News</a>
      <a href="/contribute" class="w3-bar-item w3-button w3-text-blue">Contribute</a>
    </div>

    <div class="w3-row-padding w3-padding-64 w3-container">
        <div>
             <div class="w3-quarter" style="width:260px">
		<nav class="w3-bar-block w3-collapse w3-large w3-theme-l5 w3-animate-left w3-small"  style="z-index:3;margin-left:10px" id="mySidebar">
                    <div class="w3-medium w3-text-blue" style="font-weight:bold"><div>
<a href='/wiki/Tutorials'>Tutorials
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/LearnGAMLStepByStep'>Learn GAML Step by Step
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/Introduction'>Introduction
</a><br/>
<a href='/wiki/StartWithGAML'>Start with GAML
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/ModelOrganization'>Organization of a model
</a><br/>
<a href='/wiki/BasicProgrammingConceptsInGAML'>Basic programming concepts in GAML
</a><br/>
    </div>
<a href='/wiki/ManipulateBasicSpecies'>Manipulate basic species
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/GlobalSpecies'>The global species
</a><br/>
<a href='/wiki/RegularSpecies'>Regular species
</a><br/>
<a href='/wiki/DefiningActionsAndBehaviors'>Defining actions and behaviors
</a><br/>
<a href='/wiki/InteractionBetweenAgents'>Interaction between agents
</a><br/>
<a href='/wiki/AttachingSkills'>Attaching Skills
</a><br/>
<a href='/wiki/Inheritance'>Inheritance
</a><br/>
    </div>
<a href='/wiki/DefiningAdvancedSpecies'>Defining advanced species
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/GridSpecies'>Grid Species
</a><br/>
<a href='/wiki/GraphSpecies'>Graph Species
</a><br/>
<a href='/wiki/MirrorSpecies'>Mirror species
</a><br/>
<a href='/wiki/MultiLevelArchitecture'>Multi-level architecture
</a><br/>
    </div>
<a href='/wiki/DefiningGUIExperiment'>Defining GUI Experiment
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/DefiningParameters'>Defining Parameters
</a><br/>
<a href='/wiki/DefiningDisplaysGeneralities'>Defining displays (Generalities)
</a><br/>
<a href='/wiki/DefiningCharts'>Defining Charts
</a><br/>
<a href='/wiki/Defining3DDisplays'>Defining 3D Displays
</a><br/>
<a href='/wiki/DefiningMonitorsAndInspectors'>Defining monitors and inspectors
</a><br/>
<a href='/wiki/DefiningExportFiles'>Defining export files
</a><br/>
<a href='/wiki/DefiningUserInteraction'>Defining user interaction
</a><br/>
    </div>
<a href='/wiki/ExploringModels'>Exploring Models
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/RunSeveralSimulations'>Run Several Simulations
</a><br/>
<a href='/wiki/BatchExperiments'>Defining Batch Experiments
</a><br/>
<a href='/wiki/ExplorationMethods'>Exploration Methods
</a><br/>
    </div>
<a href='/wiki/OptimizingModels'>Optimizing Models
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/RuntimeConcepts'>Runtime Concepts
</a><br/>
OptimizingModelsSelection
    </div>
<a href='/wiki/MultiParadigmModeling'>Multi-Paradigm Modeling
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/ControlArchitecture'>Control Architectures
</a><br/>
<a href='/wiki/Equations'>Using Equations
</a><br/>
    </div>
    </div>
<a href='/wiki/Recipes'>Recipes
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/ManipulateOSMDatas'>Manipulate OSM Datas
</a><br/>
<a href='/wiki/Diffusion'>Implementing diffusion
</a><br/>
<a href='/wiki/UsingDatabase'>Using Database Access
</a><br/>
<a href='/wiki/CallingR'>Calling R
</a><br/>
<a href='/wiki/UsingFIPAACL'>Using FIPA ACL
</a><br/>
<a href='/wiki/GamAnalyzer'>Using GAMAnalyzer
</a><br/>
<a href='/wiki/UsingBDI'>Using BDI
</a><br/>
<a href='/wiki/UsingDrivingSkill'>Advanced Driving Skill
</a><br/>
<a href='/wiki/ManipulateDates'>Manipulate Dates
</a><br/>
<a href='/wiki/ManipulateLight'>Implementing light
</a><br/>
<a href='/wiki/Comodel'>Using Comodel
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
—Headlessmodefordummies
    </div>
    </div>
    </div>
<a href='/wiki/Tutorials'>Tutorials
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/LuneraysFlu'>Luneray's flu
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/LuneraysFlu_step1'>1. Creation of a first basic disease spreading model
</a><br/>
<a href='/wiki/LuneraysFlu_step2'>2. Definition of monitors and chart outputs
</a><br/>
<a href='/wiki/LuneraysFlu_step3'>3. Importation of GIS data
</a><br/>
<a href='/wiki/LuneraysFlu_step4'>4. Use of a graph to constraint the movements of people]
</a><br/>
<a href='/wiki/LuneraysFlu_step5'>5. Definition of 3D displays
</a><br/>
    </div>
<a href='/wiki/IncrementalModel'>Incremental Model
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/IncrementalModel_step1'>1. Simple SI Model
</a><br/>
<a href='/wiki/IncrementalModel_step2'>2. Charts
</a><br/>
<a href='/wiki/IncrementalModel_step3'>3. Integration of GIS Data
</a><br/>
<a href='/wiki/IncrementalModel_step4'>4. Movement on Graph
</a><br/>
<a href='/wiki/IncrementalModel_step5'>5. Visualizing in 3D
</a><br/>
<a href='/wiki/IncrementalModel_step6'>6. Multi-Level
</a><br/>
<a href='/wiki/IncrementalModel_step7'>7. Differential Equations
</a><br/>
    </div>
<a href='/wiki/PredatorPrey'>Predator Prey
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/PredatorPrey_step1'>1. Basic Model
</a><br/>
<a href='/wiki/PredatorPrey_step2'>2. Vegetation Dynamic
</a><br/>
<a href='/wiki/PredatorPrey_step3'>3. Prey Agent Behavior
</a><br/>
<a href='/wiki/PredatorPrey_step4'>4. Inspectors and Monitors
</a><br/>
<a href='/wiki/PredatorPrey_step5'>5. Predator Agent
</a><br/>
<a href='/wiki/PredatorPrey_step6'>6. Breeding
</a><br/>
<a href='/wiki/PredatorPrey_step7'>7. Agent Aspect
</a><br/>
<a href='/wiki/PredatorPrey_step8'>8. Complex Behavior
</a><br/>
<a href='/wiki/PredatorPrey_step9'>9. Stopping condition
</a><br/>
<a href='/wiki/PredatorPrey_step10'>10. Charts
</a><br/>
<a href='/wiki/PredatorPrey_step11'>11. Writing Files
</a><br/>
<a href='/wiki/PredatorPrey_step12'>12. Image loading
</a><br/>
    </div>
<a href='/wiki/RoadTrafficModel'>Road Traffic
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/RoadTrafficModel_step1'>1. Loading of GIS Data
</a><br/>
<a href='/wiki/RoadTrafficModel_step2'>2. People Agents
</a><br/>
<a href='/wiki/RoadTrafficModel_step3'>3. Movement of People
</a><br/>
<a href='/wiki/RoadTrafficModel_step4'>4. Weight for Road Network
</a><br/>
<a href='/wiki/RoadTrafficModel_step5'>5. Dynamic weights
</a><br/>
<a href='/wiki/RoadTrafficModel_step6'>6. Charts
</a><br/>
<a href='/wiki/RoadTrafficModel_step7'>7. Automatic Road Repair
</a><br/>
    </div>
<a href='/wiki/ThreeD'>3D Tutorial
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/ThreeD_step1'>1. Basic Model
</a><br/>
<a href='/wiki/ThreeD_step2'>2. Moving Cells
</a><br/>
<a href='/wiki/ThreeD_step3'>3. Connections
</a><br/>
    </div>
    </div>
    </div>
<a href='/wiki/References'>References
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/PlatformDocumentation'>Platform
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/InstallationAndLaunching'>Installation and Launching
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/Installation'>Installation
</a><br/>
<a href='/wiki/Launching'>Launching GAMA
</a><br/>
<a href='/wiki/Headless'>Headless Mode
</a><br/>
<a href='/wiki/Updating'>Updating GAMA
</a><br/>
<a href='/wiki/InstallingPlugins'>Installing Plugins
</a><br/>
<a href='/wiki/Troubleshooting'>Troubleshooting
</a><br/>
    </div>
<a href='/wiki/WorkspaceProjectsAndModels'>Workspace, Projects and Models
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/NavigatingWorkspace'>Navigating in the Workspace
</a><br/>
<a href='/wiki/ChangingWorkspace'>Changing Workspace
</a><br/>
<a href='/wiki/ImportingModels'>Importing Models
</a><br/>
    </div>
<a href='/wiki/EditingModels'>Editing models
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/GamlEditorGeneralities'>The GAML Editor - Generalities
</a><br/>
<a href='/wiki/GamlEditorToolbar'>The GAML Editor Toolbar
</a><br/>
<a href='/wiki/ValidationOfModels'>Validation of Models
</a><br/>
    </div>
<a href='/wiki/RunningExperiments'>Running Experiments
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/LaunchingExperiments'>Launching Experiments from the User Interface
</a><br/>
<a href='/wiki/ExperimentsUserInterface'>Experiments User Interface
</a><br/>
<a href='/wiki/MenusAndCommands'>Menus and Commands
</a><br/>
<a href='/wiki/ParametersView'>Parameters View
</a><br/>
<a href='/wiki/InspectorsAndMonitors'>Inspectors and monitors
</a><br/>
<a href='/wiki/Displays'>Displays
</a><br/>
<a href='/wiki/BatchSpecific'>Batch Specific UI
</a><br/>
<a href='/wiki/ErrorsView'>Errors View
</a><br/>
    </div>
<a href='/wiki/Preferences'>Preferences
</a><br/>
    </div>
<a href='/wiki/GamlReferences'>Gaml Reference
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/BuiltInSpecies'>Built-in Species
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/AgentBuiltIn'>The 'agent' built-in species (Under Construction)
</a><br/>
<a href='/wiki/ModelBuiltIn'>The 'model' built-in species (Under Construction)
</a><br/>
<a href='/wiki/ExperimentBuiltIn'>The 'experiment' built-in species (Under Construction)
</a><br/>
    </div>
<a href='/wiki/BuiltInSkills'>Built-in Skills
</a><br/>
<a href='/wiki/BuiltInArchitectures'>Built-in Architectures
</a><br/>
<a href='/wiki/Statements'>Statements
</a><br/>
<a href='/wiki/DataTypes'>Types
</a><br/>
<a href='/wiki/FileTypes'>File Types
</a><br/>
<a href='/wiki/Expressions'>Expressions
</a><br/>
      <div id='sub' class=' w3-padding-small w3-bar-block w3-small'>
<a href='/wiki/Literals'>Literals
</a><br/>
<a href='/wiki/UnitsAndConstants'>Units and constants
</a><br/>
<a href='/wiki/PseudoVariables'>Pseudo-variables
</a><br/>
<a href='/wiki/VariablesAndAttributes'>Variables and Attributes
</a><br/>
<a href='/wiki/Operators'>Operators 
</a><br/>
    </div>
    </div>
    </div>
Community
</div></div></nav></div>
    <div class="w3-threequarter">
        <h1 id="3-movement-of-people">3. Movement of People</h1>

<p>This third step presents how to create a road system from GIS data. More precisely, it shows how to build a graph from a list of polylines and to constrain the movement of an agent according to this graph.</p>

<h2 id="formulation">Formulation</h2>
<ul>
  <li>Definition of day_time global variable that will indicate, according to the simulation step, the time of the day: each simulation step will represent 10 minutes, then the day_time variable will be ranged between 0 and 144.</li>
  <li>For each <strong>people</strong> agent: define a living_place(building of type ‘Residential’) and working place (building of type ‘Industrial’).</li>
  <li>For each <strong>people</strong> agent: define start_work and end_work hours that respectively represent when the agent leaves its house to go to work and when it leaves its working_place to go back home. These hours will be randomly define between 36 (6 a.m;) and 60 (10 a.m.) for the start_work and 84 (2p.m.) and 132 (10p.m.) for the end_work.</li>
  <li>For each <strong>people</strong> agent: define a objective variable: this one can ‘go home’ or ‘working’.</li>
  <li>For each <strong>people</strong> agent: define a speed. The speed will be randomly define between 50 and 100.</li>
  <li>The <strong>people</strong> agents move along the road, taking the shortest path.</li>
</ul>

<h2 id="model-definition">Model Definition</h2>

<h3 id="people-agents">people agents</h3>
<p>First, we have to change the skill of the <strong>people</strong> agents: as we want to use an action of the <strong>moving</strong> skill (<strong>goto</strong>), we will provide the <strong>people</strong> agents with this skill. A <a href="AttachingSkills">skill</a> is a built-in module that provide the modeler a self-contain and relevant set of actions and variables.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>   species people skills: [moving]{
       ...
   }
</code></pre>
</div>

<p>Then, we have to add new variables to the people agents: living_place, working_place, start_work, end_work, objective. In addition, we will add a “the_target” variable that will represents the point toward which the agent will be currently moving.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>   species people skills: [moving]{
	rgb color &lt;- #yellow ;
	building living_place &lt;- nil ;
	building working_place &lt;- nil ;
	int start_work ;
	int end_work  ;
	string objective ; 
	point the_target &lt;- nil ;
      
       ...
   }
</code></pre>
</div>

<p>We define two reflex methods that allow to change the objective (and the_target) of the agent at the start_work and en_work hours. Concerning the <em>target value</em>, we choose a random point in the objective building (working_place or living_place) by using the <strong>any_location_in</strong> operator.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>   species people skills: [moving]{  
      ...
      reflex time_to_work when: current_hour = start_work and objective = "resting"{
           objective &lt;- "working" ;
	   the_target &lt;- any_location_in (working_place);
      }
		
      reflex time_to_go_home when: current_hour = end_work and objective = "working"{
	   objective &lt;- "resting" ;
	   the_target &lt;- any_location_in (living_place); 
      } 
      ...
  }
</code></pre>
</div>

<p>At last, we define a reflex method that allows the agent to move. If a target point is defined (the_target != nil), the agent moves in direction to its target using the <strong>goto</strong> action (provided by the moving skill). Note that we specified a graph to constraint the movement of the agents on the road network with the facet <strong>on</strong>. We will see later how this graph is built. The agent uses the shortest path (according to the graph) to go to the target point. When the agent arrives at destination (the_target = location), the target is set to nil (the agent will stop moving).</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  species people skills: [moving]{
      ...
      reflex move when: the_target != nil {
	  do goto target: the_target on: the_graph ; 
	  if the_target = location {
		the_target &lt;- nil ;
	  }
     }
  }
</code></pre>
</div>

<h3 id="parameters">parameters</h3>
<p>We add several parameters (<strong>min_work_start</strong>, <strong>max_work_start</strong>, <strong>min_work_end</strong>, <strong>max_work_end</strong>, <strong>min_speed</strong> and <strong>max_speed</strong>) and two global variables: <strong>the_graph</strong> (graph computed from the road network) and <strong>current_hour</strong> (current hour of the day). The value of the <strong>current_hour</strong> variable is automatically computed at each simulation step and is equals to “(time(the simulation step <strong>step) / 1 hour) modulo 24”.</strong></p>

<p>In the global section:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>global {
        ...
        int current_hour update: (time / #hour) mod 24;
	int min_work_start &lt;- 6;
	int max_work_start &lt;- 8;
	int min_work_end &lt;- 16; 
	int max_work_end &lt;- 20; 
	float min_speed &lt;- 1.0 #km / #h;
	float max_speed &lt;- 5.0 #km / #h; 
	graph the_graph;
        ...
}
</code></pre>
</div>

<p>In the experiment section:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>experiment road_traffic type: gui {
        ... 
	parameter "Earliest hour to start work" var: min_work_start category: "People" min: 2 max: 8;
	parameter "Latest hour to start work" var: max_work_start category: "People" min: 8 max: 12;
	parameter "Earliest hour to end work" var: min_work_end category: "People" min: 12 max: 16;
	parameter "Latest hour to end work" var: max_work_end category: "People" min: 16 max: 23;
	parameter "minimal speed" var: min_speed category: "People" min: 0.1 #km/#h ;
	parameter "maximal speed" var: max_speed category: "People" max: 10 #km/#h;
        ...
}
</code></pre>
</div>
<h3 id="initialization">initialization</h3>
<p>First, we need to compute from the <strong>road</strong> agents, a graph for the moving of the <strong>people</strong> agents. The operator <strong>as_edge_graph</strong> allows to do that. It automatically builds from a set of agents or geometries a graph where the agents are the edges of the graph, a node represent the extremities of the agent geometry.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>   init {
      ...
      create road from: shape_file_roads ;
      the_graph &lt;- as_edge_graph(road);
      ...
   }
</code></pre>
</div>

<p>We randomly assign one working place and one house to each <strong>people</strong> agent. To simplify the GAML code, we define two temporary variables: the list of buildings of type ‘Residential’ and the list of buildings of type ‘Industrial’ (by using the <strong>where</strong> command). At the creation of each <strong>people</strong> agent, we define a speed, a start_work and end_work to each <strong>people</strong> agent (according to the min and max define in the parameters). We define as well an initial objective (“resting”). Concerning the definition of the living_place and working_place, these ones are randomly chosen in the residential_buildings and industrial_buildings lists.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>   init {
      ...
      list&lt;building&gt; residential_buildings &lt;- building where (each.type="Residential");
      list&lt;building&gt;  industrial_buildings &lt;- building  where (each.type="Industrial") ;
      create people number: nb_people {
          speed &lt;- min_speed + rnd (max_speed - min_speed) ;
          start_work &lt;- min_work_start + rnd (max_work_start - min_work_start) ;
          end_work &lt;- min_work_end + rnd (max_work_end - min_work_end) ;
          living_place &lt;- one_of(residential_buildings) ;
          working_place &lt;- one_of(industrial_buildings) ;
          objective &lt;- "resting";
          location &lt;- any_location_in (living_place); 
      }
      ...
  }
</code></pre>
</div>

<h2 id="complete-model">Complete Model</h2>

<div class="highlighter-rouge"><pre class="highlight"><code>model tutorial_gis_city_traffic

global {
	file shape_file_buildings &lt;- file("../includes/building.shp");
	file shape_file_roads &lt;- file("../includes/road.shp");
	file shape_file_bounds &lt;- file("../includes/bounds.shp");
	geometry shape &lt;- envelope(shape_file_bounds);
	float step &lt;- 10 #mn;
	int nb_people &lt;- 100;
	int current_hour update: (time / #hour) mod 24;
	int min_work_start &lt;- 6;
	int max_work_start &lt;- 8;
	int min_work_end &lt;- 16; 
	int max_work_end &lt;- 20; 
	float min_speed &lt;- 1.0 #km / #h;
	float max_speed &lt;- 5.0 #km / #h; 
	graph the_graph;
	
	init {
		create building from: shape_file_buildings with: [type::string(read ("NATURE"))] {
			if type="Industrial" {
				color &lt;- #blue ;
			}
		}
		create road from: shape_file_roads ;
		the_graph &lt;- as_edge_graph(road);
		
		list&lt;building&gt; residential_buildings &lt;- building where (each.type="Residential");
		list&lt;building&gt;  industrial_buildings &lt;- building  where (each.type="Industrial") ;
		create people number: nb_people {
			speed &lt;- min_speed + rnd (max_speed - min_speed) ;
			start_work &lt;- min_work_start + rnd (max_work_start - min_work_start) ;
			end_work &lt;- min_work_end + rnd (max_work_end - min_work_end) ;
			living_place &lt;- one_of(residential_buildings) ;
			working_place &lt;- one_of(industrial_buildings) ;
			objective &lt;- "resting";
			location &lt;- any_location_in (living_place); 
		}
	}
}

species building {
	string type; 
	rgb color &lt;- #gray  ;
	
	aspect base {
		draw shape color: color ;
	}
}

species road  {
	rgb color &lt;- #black ;
	aspect base {
		draw shape color: color ;
	}
}

species people skills:[moving] {
	rgb color &lt;- #yellow ;
	building living_place &lt;- nil ;
	building working_place &lt;- nil ;
	int start_work ;
	int end_work  ;
	string objective ; 
	point the_target &lt;- nil ;
		
	reflex time_to_work when: current_hour = start_work and objective = "resting"{
		objective &lt;- "working" ;
		the_target &lt;- any_location_in (working_place);
	}
		
	reflex time_to_go_home when: current_hour = end_work and objective = "working"{
		objective &lt;- "resting" ;
		the_target &lt;- any_location_in (living_place); 
	} 
	 
	reflex move when: the_target != nil {
		do goto target: the_target on: the_graph ; 
		if the_target = location {
			the_target &lt;- nil ;
		}
	}
	
	aspect base {
		draw circle(10) color: color;
	}
}

experiment road_traffic type: gui {
	parameter "Shapefile for the buildings:" var: shape_file_buildings category: "GIS" ;
	parameter "Shapefile for the roads:" var: shape_file_roads category: "GIS" ;
	parameter "Shapefile for the bounds:" var: shape_file_bounds category: "GIS" ;
	parameter "Number of people agents" var: nb_people category: "People" ;
	parameter "Earliest hour to start work" var: min_work_start category: "People" min: 2 max: 8;
	parameter "Latest hour to start work" var: max_work_start category: "People" min: 8 max: 12;
	parameter "Earliest hour to end work" var: min_work_end category: "People" min: 12 max: 16;
	parameter "Latest hour to end work" var: max_work_end category: "People" min: 16 max: 23;
	parameter "minimal speed" var: min_speed category: "People" min: 0.1 #km/#h ;
	parameter "maximal speed" var: max_speed category: "People" max: 10 #km/#h;
	
	output {
		display city_display type:opengl {
			species building aspect: base ;
			species road aspect: base ;
			species people aspect: base ;
		}
	}
}
</code></pre>
</div>

    </div>
    </div>
    </div>
    </body></html>
